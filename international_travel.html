<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Europe Trip Checklist</title>
  <style>
    :root{
      --bg:#0b0c10;
      --card:#121319;
      --ink:#e8ecf1;
      --muted:#a7b0ba;
      --accent:#8fd3fe;
      --accent-2:#7ef0c1;
      --danger:#ff6b6b;
      --ok:#9cff9c;
      --ring: 0 0 0 3px rgba(143,211,254,.35);
    }
    html,body{height:100%;}
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 100% -10%, rgba(126,240,193,.08), transparent 60%),
                  radial-gradient(1100px 500px at -20% 10%, rgba(143,211,254,.09), transparent 60%),
                  var(--bg);
      color:var(--ink);
    }
    .container{
      max-width:1100px; margin:32px auto; padding:0 16px 80px; 
    }
    header{
      display:flex; align-items:center; gap:16px; justify-content:space-between; flex-wrap:wrap;
    }
    .title{
      font-size:clamp(20px, 3.4vw, 32px); letter-spacing:.3px; font-weight:700; display:flex; align-items:center; gap:10px;
    }
    .title svg{opacity:.9}
    .controls{
      display:flex; gap:8px; flex-wrap:wrap;
    }
    button, .chip{
      appearance:none; border:none; background:linear-gradient(180deg, #1b1e27, #131622);
      color:var(--ink); padding:10px 14px; border-radius:14px; cursor:pointer; font-weight:600; letter-spacing:.2px;
      box-shadow: 0 1px 0 rgba(255,255,255,.04) inset, 0 0 0 1px rgba(255,255,255,.06), 0 6px 20px rgba(0,0,0,.25);
      transition: transform .04s ease, box-shadow .2s ease, background .2s ease;
    }
    button:hover{box-shadow: 0 1px 0 rgba(255,255,255,.05) inset, 0 0 0 1px rgba(143,211,254,.35), 0 10px 30px rgba(143,211,254,.12)}
    button:active{transform:translateY(1px)}
    button.primary{background: linear-gradient(180deg, #1c2a3b, #122132); border:1px solid rgba(143,211,254,.45)}
    button.danger{background: linear-gradient(180deg, #351d1d, #281415); border:1px solid rgba(255,107,107,.45)}
    .search{
      flex:1 1 280px; min-width:230px; display:flex; align-items:center; gap:10px; background: linear-gradient(180deg, #191c25, #141826); border-radius:14px;
      padding:8px 12px; box-shadow: 0 0 0 1px rgba(255,255,255,.06);
    }
    .search input{flex:1; background:transparent; border:none; color:var(--ink); outline:none; padding:8px; font-size:14px}
    .search input::placeholder{color:var(--muted)}

    .grid{display:grid; grid-template-columns: repeat(1, minmax(0,1fr)); gap:16px; margin-top:18px}
    @media (min-width:860px){.grid{grid-template-columns: repeat(2, minmax(0,1fr));}}

    section.card{
      background:linear-gradient(180deg, #12141c, #0f1119); border-radius:18px; padding:14px 14px 8px; position:relative;
      box-shadow: 0 0 0 1px rgba(255,255,255,.06), 0 12px 30px rgba(0,0,0,.35);
    }
    .card header{
      gap:10px; margin-bottom:6px; align-items:flex-start;
    }
    .h2{font-size:16px; font-weight:700; display:flex; align-items:center; gap:10px}
    .meta{color:var(--muted); font-size:12px}
    .sec-controls{display:flex; gap:6px; flex-wrap:wrap}
    .list{display:grid; grid-template-columns:1fr; gap:4px; margin-top:8px;}

    label.item{ display:flex; gap:10px; align-items:flex-start; padding:8px 10px; border-radius:12px; cursor:pointer; 
      transition: background .15s ease, transform .02s ease; 
    }
    label.item:hover{ background: rgba(143,211,254,.07)}
    .item input{width:18px; height:18px; margin-top:2px}
    .item .txt{line-height:1.25}

    .count{font-variant-numeric: tabular-nums; padding:4px 8px; background:rgba(143,211,254,.12); color:var(--accent); border-radius:10px; font-weight:700}

    .footer{margin-top:18px; display:flex; gap:10px; justify-content:flex-end; align-items:center}
    .footer .stamp{color:var(--muted); font-size:12px}

    /* Dialog */
    dialog{border:none; padding:0; background:transparent}
    .modal{background:linear-gradient(180deg, #171924, #10121b); border-radius:18px; width:min(560px, 92vw); box-shadow: 0 20px 70px rgba(0,0,0,.6); border:1px solid rgba(255,255,255,.06)}
    .modal header{padding:16px 16px 0}
    .modal .body{padding:12px 16px 16px}

    .add-form{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .add-form input, .add-form select{
      background:#0f1220; color:var(--ink); border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:10px 12px; outline:none;
    }
    .add-form input:focus, .add-form select:focus{box-shadow: var(--ring)}

    /* Print */
    @media print{
      .controls, .sec-controls, .footer button, .search, dialog{display:none !important}
      body{background:white; color:black}
      section.card{box-shadow:none; border:1px solid #ddd; background:white}
      .container{padding:0 0 0; margin:10px auto}
      header{margin-bottom:6px}
      .grid{gap:8px}
      .h2{color:#111}
      .meta{color:#333}
      .title{font-size:20px}
      a{color:black}
    }
  </style>
</head>
<body>
  <div class="container" id="app">
    <header>
      <div class="title" aria-label="Europe Trip Checklist">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Europe trip checklist
      </div>
      <div class="search" role="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="q" placeholder="Filter items… (e.g., passport, adapter)" autocomplete="off" />
      </div>
      <div class="controls" role="group" aria-label="global controls">
        <button class="primary" id="btnPrint" title="Print or save as PDF">Print</button>
        <button id="btnExpand">Expand all</button>
        <button id="btnCollapse">Collapse all</button>
        <button class="danger" id="btnReset" title="Uncheck everything">Reset</button>
        <button id="btnAdd">Add custom item</button>
      </div>
    </header>

    <div class="grid" id="grid"></div>

    <div class="footer">
      <span class="stamp" id="saveState">Changes are saved automatically.</span>
      <span class="stamp" id="lastSaved"></span>
    </div>
  </div>

  <dialog id="addDialog">
    <div class="modal">
      <header>
        <div class="title" style="font-size:18px">Add a custom item</div>
      </header>
      <div class="body">
        <form class="add-form" id="addForm">
          <label style="display:none" for="addText">Item</label>
          <input id="addText" required placeholder="e.g., City museum pass" />
          <label style="display:none" for="addSection">Section</label>
          <select id="addSection"></select>
          <button class="primary" type="submit">Add</button>
          <button type="button" id="addCancel">Cancel</button>
        </form>
      </div>
    </div>
  </dialog>

  <script>
    const STORAGE_KEY = 'europe_trip_checklist_v1';

    const data = [
      { id:'identity', name:'Identity & money', items:[
        'Passport', 'Passport copies (printed & digital)', 'Visas (if required)', 'Driver\'s license', 'International Driving Permit',
        'Credit card(s)', 'Debit/ATM card', 'Backup card (stored separately)', 'Local currency (cash)', 'Emergency hidden cash (€100–200)', 'Travel insurance documents', 'Student/teacher ID'
      ]},
      { id:'electronics', name:'Electronics', items:[
        'Universal power adapter (EU Type C/E/F)', 'Phone + charger', 'Laptop/tablet + charger (if needed)', 'Portable power bank', 'Headphones/earbuds',
        'SIM/eSIM or roaming plan', 'Camera (optional)', 'Extra memory card', 'Backup storage (USB/drive or cloud access)', 'E‑reader + charger (optional)', 'AirTag/Tile for bags (optional)'
      ]},
      { id:'toiletries', name:'Toiletries & personal care', items:[
        'Toothbrush', 'Toothpaste', 'Floss', 'Deodorant', 'Shampoo', 'Conditioner', 'Soap/body wash', 'Face wash', 'Moisturizer', 'Sunscreen', 'Lip balm (SPF)',
        'Razor', 'Shaving cream/gel', 'Hairbrush/comb', 'Hair ties/clips', 'Feminine hygiene products', 'Nail clippers', 'Tweezers', 'Pain relief meds', 'Allergy meds',
        'Cold meds', 'Sleep aid (melatonin)', 'First‑aid kit', 'Band‑aids', 'Antiseptic wipes', 'Prescriptions (with copies)', 'Quick‑dry travel towel'
      ]},
      { id:'clothes', name:'Clothes & footwear', items:[
        'Tops ×5', 'Bottoms ×3', 'Dress/jumpsuit or smart shirt', 'Mid‑layers ×2 (sweater/fleece)', 'Outer layer (rain shell/trench)', 'Seasonal extras (coat/thermals or linen/sun hat)',
        'Underwear (7–10)', 'Socks (5–7)', 'Sleepwear', 'Swimwear', 'Workout/hike outfit', 'Walking shoes (broken‑in)', 'Dressier shoes', 'Sandals/boots (seasonal)',
        'Scarf/shawl', 'Belt', 'Simple jewelry', 'Packing cubes/compression bags', 'Lint roller', 'Mini sewing kit/safety pins', 'Reusable tote', 'Spare outfit in carry‑on'
      ]},
      { id:'comfort', name:'Comfort & convenience', items:[
        'Eye mask', 'Earplugs', 'Neck pillow', 'Snacks', 'Reusable utensils/spork', 'Journal + pen', 'Compact umbrella', 'Electrolyte packets', 'Hand sanitizer', 'Wipes',
        'Laundry kit (detergent sheets)', 'Sink stopper', 'Travel clothesline', 'Stain stick'
      ]},
      { id:'security', name:'Security', items:[
        'Crossbody/day bag with zippers', 'Luggage locks', 'RFID wallet/money belt', 'Document photocopies (stored separately)', 'Backup card stored separately', 'Trackers for bags (AirTag/Tile)'
      ]},
      { id:'logistics', name:'Logistics & reservations', items:[
        'Flight tickets/boarding passes', 'Train/rail passes & tickets', 'Hotel/Airbnb confirmations (address + contact)', 'Airport transfers booked', 'Lounge card/priority pass',
        'Public transport cards/apps', 'Car rental + insurance', 'Driving routes & toll info', 'Restaurant/attraction reservations', 'Emergency contacts (embassy/consulate)',
        'Offline maps (Google Maps/Citymapper)', 'Translation app (Google Translate/DeepL)', 'Guidebook/offline notes'
      ]},
      { id:'preleave', name:'Before leaving home', items:[
        'Set bill autopay', 'Out‑of‑office email', 'Hold mail arranged', 'Pet/house care arranged', 'Notify bank/credit cards', 'Cloud backup of documents',
        'Download tickets & maps offline', 'Check passport validity (6+ months)', 'Set roaming or buy eSIM', 'Check weather & adjust packing', 'Check baggage/liquids rules',
        'Obtain International Driving Permit (if needed)'
      ]}
    ];

    // State: { checked: {"identity|Passport": true}, collapsed: {sectionId: bool} }
    const state = loadState();

    const grid = document.getElementById('grid');

    // Render
    data.forEach(sec => grid.appendChild(renderSection(sec)));

    // Populate add dialog select
    const addSectionSel = document.getElementById('addSection');
    data.forEach(s=>{
      const o=document.createElement('option'); o.value=s.id; o.textContent=s.name; addSectionSel.appendChild(o);
    });

    // Wire global controls
    document.getElementById('btnPrint').addEventListener('click', ()=>window.print());
    document.getElementById('btnReset').addEventListener('click', ()=>{ if(confirm('Uncheck all items?')){ state.checked={}; saveState(); refreshAllCounts(); refreshChecksFromState(); } });
    document.getElementById('btnExpand').addEventListener('click', ()=>{ data.forEach(s=>state.collapsed[s.id]=false); saveState(); document.querySelectorAll('details').forEach(d=>d.open=true); });
    document.getElementById('btnCollapse').addEventListener('click', ()=>{ data.forEach(s=>state.collapsed[s.id]=true); saveState(); document.querySelectorAll('details').forEach(d=>d.open=false); });

    // Filter
    document.getElementById('q').addEventListener('input', (e)=>{
      const term = e.target.value.trim().toLowerCase();
      document.querySelectorAll('label.item').forEach(l=>{
        const show = l.dataset.txt.includes(term);
        l.style.display = show ? '' : 'none';
      });
    });

    // Add item dialog
    const addDialog = document.getElementById('addDialog');
    document.getElementById('btnAdd').addEventListener('click', ()=>{ document.getElementById('addText').value=''; addDialog.showModal(); setTimeout(()=>document.getElementById('addText').focus(), 50); });
    document.getElementById('addCancel').addEventListener('click', ()=>addDialog.close());
    document.getElementById('addForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const text = document.getElementById('addText').value.trim();
      const secId = document.getElementById('addSection').value;
      if(!text) return;
      const sec = data.find(s=>s.id===secId);
      sec.items.push(text);
      // Append to DOM
      const secEl = document.querySelector(`section.card[data-id="${secId}"] .list`);
      secEl.appendChild(renderItem(secId, text));
      refreshAllCounts();
      addDialog.close();
      saveState();
    });

    // Helpers
    function keyOf(sectionId, label){ return sectionId + '|' + label; }

    function renderSection(sec){
      const wrapper = document.createElement('section');
      wrapper.className='card';
      wrapper.dataset.id = sec.id;

      const det = document.createElement('details');
      det.open = !(state.collapsed && state.collapsed[sec.id]);

      const sum = document.createElement('summary');
      sum.style.listStyle='none';

      const head = document.createElement('div');
      head.className='h2';
      head.innerHTML = `<span>${sec.name}</span> <span class="count" id="count-${sec.id}">0/0</span>`;

      const sc = document.createElement('div');
      sc.className='sec-controls';

      const btnAll = document.createElement('button'); btnAll.textContent='Check all'; btnAll.addEventListener('click', (ev)=>{ ev.preventDefault(); toggleSection(sec.id, true); });
      const btnNone = document.createElement('button'); btnNone.textContent='Uncheck'; btnNone.addEventListener('click', (ev)=>{ ev.preventDefault(); toggleSection(sec.id, false); });

      sc.appendChild(btnAll); sc.appendChild(btnNone);

      const headWrap = document.createElement('div'); headWrap.appendChild(head); headWrap.appendChild(sc);
      const sumHeader = document.createElement('div'); sumHeader.appendChild(headWrap);
      sum.appendChild(sumHeader);

      det.appendChild(sum);

      const list = document.createElement('div'); list.className='list';
      sec.items.forEach(label=> list.appendChild(renderItem(sec.id, label)) );

      det.appendChild(list);
      wrapper.appendChild(det);

      det.addEventListener('toggle', ()=>{ state.collapsed = state.collapsed || {}; state.collapsed[sec.id] = !det.open; saveState(); });

      // Initial count
      refreshCount(sec.id);

      return wrapper;
    }

    function renderItem(sectionId, label){
      const id = 'i_' + btoa(encodeURIComponent(keyOf(sectionId,label))).replace(/=/g,'');
      const lab = document.createElement('label');
      lab.className='item'; lab.htmlFor=id; lab.dataset.txt = label.toLowerCase();

      const cb = document.createElement('input'); cb.type='checkbox'; cb.id=id; cb.checked = !!(state.checked && state.checked[keyOf(sectionId,label)]);
      cb.addEventListener('change', ()=>{
        setChecked(sectionId, label, cb.checked);
        refreshCount(sectionId);
      });

      const span = document.createElement('div'); span.className='txt'; span.textContent = label;

      lab.appendChild(cb); lab.appendChild(span);
      return lab;
    }

    function toggleSection(sectionId, value){
      document.querySelectorAll(`section.card[data-id="${sectionId}"] input[type=checkbox]`).forEach(cb=>{ cb.checked = value; const label = cb.parentElement.querySelector('.txt').textContent; setChecked(sectionId, label, value); });
      refreshCount(sectionId);
    }

    function refreshCount(sectionId){
      const section = data.find(s=>s.id===sectionId);
      const total = document.querySelectorAll(`section.card[data-id="${sectionId}"] input[type=checkbox]`).length;
      const done = section.items.filter(label => state.checked && state.checked[keyOf(sectionId,label)]).length;
      const el = document.getElementById('count-'+sectionId); if(el) el.textContent = `${done}/${total}`;
    }

    function refreshAllCounts(){ data.forEach(s=>refreshCount(s.id)); updateSavedStamp(); }

    function refreshChecksFromState(){
      document.querySelectorAll('label.item').forEach(l=>{
        const sectionId = l.closest('section.card').dataset.id; const label = l.querySelector('.txt').textContent;
        const chk = !!(state.checked && state.checked[keyOf(sectionId,label)]);
        const cb = l.querySelector('input[type=checkbox]'); if(cb) cb.checked = chk;
      });
    }

    function setChecked(sectionId, label, checked){
      state.checked = state.checked || {}; 
      if(checked) state.checked[keyOf(sectionId,label)] = true; else delete state.checked[keyOf(sectionId,label)];
      saveState();
    }

    function saveState(){
      try{
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        updateSavedStamp();
      }catch(e){ console.warn('Could not save state', e); }
    }
    function loadState(){
      try{ return JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); }
      catch(e){ return {}; }
    }
    function updateSavedStamp(){
      const el = document.getElementById('lastSaved');
      const now = new Date();
      el.textContent = 'Last saved ' + now.toLocaleString();
    }

    // Kick an initial stamp
    updateSavedStamp();
  </script>
</body>
</html>
